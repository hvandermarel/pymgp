
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pymgp.crstrans.neu2xyz &#8212; pyMGP 0.9 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=049aceee"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/generated/pymgp.crstrans.neu2xyz';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="pymgp.crstrans.xyz2zas" href="pymgp.crstrans.xyz2zas.html" />
    <link rel="prev" title="pymgp.crstrans.xyz2neu" href="pymgp.crstrans.xyz2neu.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">pyMGP 0.9 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../usage.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../api.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../release.html">
    Release notes
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../usage.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../api.html">
    API reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../release.html">
    Release notes
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../crstrans.html">Coordinate conversions and transformations (<code class="xref py py-mod docutils literal notranslate"><span class="pre">pymgp.crstrans</span></code>)</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pymgp.crstrans.xyz2plh.html">pymgp.crstrans.xyz2plh</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.crstrans.plh2xyz.html">pymgp.crstrans.plh2xyz</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.crstrans.inqell.html">pymgp.crstrans.inqell</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.crstrans.setell.html">pymgp.crstrans.setell</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.crstrans.ellcurvature.html">pymgp.crstrans.ellcurvature</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.crstrans.xyz2neu.html">pymgp.crstrans.xyz2neu</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">pymgp.crstrans.neu2xyz</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.crstrans.xyz2zas.html">pymgp.crstrans.xyz2zas</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.crstrans.zas2xyz.html">pymgp.crstrans.zas2xyz</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.crstrans.ellnormal.html">pymgp.crstrans.ellnormal</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.crstrans.ellrotmatrix.html">pymgp.crstrans.ellrotmatrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.crstrans.covtransform.html">pymgp.crstrans.covtransform</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.crstrans.printcrd.html">pymgp.crstrans.printcrd</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.crstrans.printxyz.html">pymgp.crstrans.printxyz</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.crstrans.printplh.html">pymgp.crstrans.printplh</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.crstrans.deg2dms.html">pymgp.crstrans.deg2dms</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../satorb.html">Satellite orbits (<code class="xref py py-mod docutils literal notranslate"><span class="pre">pymgp.satorb</span></code>)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pymgp.satorb.vec2orb.html">pymgp.satorb.vec2orb</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.satorb.orb2vec.html">pymgp.satorb.orb2vec</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.satorb.orbtype.html">pymgp.satorb.orbtype</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.satorb.kepler.html">pymgp.satorb.kepler</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.satorb.keplerm.html">pymgp.satorb.keplerm</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.satorb.keplernu.html">pymgp.satorb.keplernu</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.satorb.ut2gmst.html">pymgp.satorb.ut2gmst</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.satorb.ecef2eci.html">pymgp.satorb.ecef2eci</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.satorb.eci2ecef.html">pymgp.satorb.eci2ecef</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.satorb.satlookangle.html">pymgp.satorb.satlookangle</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.satorb.prtlookangle.html">pymgp.satorb.prtlookangle</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.satorb.datetime2num.html">pymgp.satorb.datetime2num</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.satorb.num2datetime.html">pymgp.satorb.num2datetime</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.satorb.num2datetime64.html">pymgp.satorb.num2datetime64</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tleorb.html">Two-Line Element (TLE) orbits(<code class="xref py py-mod docutils literal notranslate"><span class="pre">pymgp.tleorb</span></code>)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pymgp.tleorb.tleget.html">pymgp.tleorb.tleget</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.tleorb.tleread.html">pymgp.tleorb.tleread</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.tleorb.tleprint.html">pymgp.tleorb.tleprint</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.tleorb.tlefind.html">pymgp.tleorb.tlefind</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.tleorb.tledatenum.html">pymgp.tleorb.tledatenum</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.tleorb.tle2orb.html">pymgp.tleorb.tle2orb</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.tleorb.tle2vec.html">pymgp.tleorb.tle2vec</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../orbplot.html">Satellite orbit and visibility plots (<code class="xref py py-mod docutils literal notranslate"><span class="pre">pymgp.orbplot</span></code>)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="pymgp.orbplot.pltposvel.html">pymgp.orbplot.pltposvel</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.orbplot.pltsattrack.html">pymgp.orbplot.pltsattrack</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.orbplot.pltgroundtrack.html">pymgp.orbplot.pltgroundtrack</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.orbplot.pltsatview.html">pymgp.orbplot.pltsatview</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.orbplot.skyplot.html">pymgp.orbplot.skyplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.orbplot.plt3dorbit.html">pymgp.orbplot.plt3dorbit</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.orbplot.plot_orbit_3D.html">pymgp.orbplot.plot_orbit_3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.orbplot.rewrap.html">pymgp.orbplot.rewrap</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.orbplot.rewrap2d.html">pymgp.orbplot.rewrap2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.orbplot.xlabels.html">pymgp.orbplot.xlabels</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.orbplot.plh2ecef.html">pymgp.orbplot.plh2ecef</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.orbplot.plh2eci.html">pymgp.orbplot.plh2eci</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.orbplot.ecef2plh.html">pymgp.orbplot.ecef2plh</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.orbplot.obj2sat.html">pymgp.orbplot.obj2sat</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.orbplot.xyz2radec.html">pymgp.orbplot.xyz2radec</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.orbplot.xyz2zassp.html">pymgp.orbplot.xyz2zassp</a></li>
<li class="toctree-l2"><a class="reference internal" href="pymgp.orbplot.ra2lon.html">pymgp.orbplot.ra2lon</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../api.html" class="nav-link">API reference</a></li>
    
    
    <li class="breadcrumb-item"><a href="../crstrans.html" class="nav-link">Coordinate conversions and transformations (<code class="xref py py-mod docutils literal notranslate"><span class="pre">pymgp.crstrans</span></code>)</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">pymgp.crstrans.neu2xyz</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="pymgp-crstrans-neu2xyz">
<h1>pymgp.crstrans.neu2xyz<a class="headerlink" href="#pymgp-crstrans-neu2xyz" title="Link to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="pymgp.crstrans.neu2xyz">
<span class="sig-prename descclassname"><span class="pre">pymgp.crstrans.</span></span><span class="sig-name descname"><span class="pre">neu2xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ref'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plh'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rad'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotmatrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pymgp/crstrans.html#neu2xyz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymgp.crstrans.neu2xyz" title="Link to this definition">#</a></dt>
<dd><p>Convert local coordinates (North,East,Up) to Cartesian coordinates aligned to the ECEF frame.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>neu</strong><span class="classifier">array_like with shape (…,3)</span></dt><dd><p>Local North, East, Up coordinates with respect to the point(s) in <cite>ref</cite>.</p>
</dd>
<dt><strong>ref</strong><span class="classifier">array_like with shape (…,3) or (…,2)</span></dt><dd><p>Reference position(s) on the ellipsoid. The type of coordinates are specified by <cite>mode</cite>.
‘ref’ can be a vector with a single coordinate triplet/doublet or have a similar shape
to <cite>neu</cite>. The North, East, Up coordinates for the(se) point(s) are (0, 0, 0). In case <cite>ref</cite>
is a single coordinate triplet/doublet then the same reference points is used for all
the points in <cite>neu</cite>.</p>
</dd>
<dt><strong>origin</strong><span class="classifier">{‘ref’, ‘ecef’}, default=’ref’</span></dt><dd><p>Origin of the coordinates in the output XYZ coordinates. If origin=’ref’ then the XYZ 
coordinates in the output are with respect to the point(s) given in <cite>ref</cite>. The other 
possibility is coordinates in the ECEF reference frame with the origin at the center 
of the Earth.</p>
</dd>
<dt><strong>mode</strong><span class="classifier">{‘plh’, ‘xyz’,’normal’}, default = ‘plh’</span></dt><dd><p>Coordinate type for <cite>ref</cite>. Possible values are:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘plh’ : <cite>ref</cite> contains the geographic latitude and longitude with the unit 
specified by <cite>unit</cite>. A third coordinate with the height is optional.</p></li>
<li><p>‘xyz’ : <cite>ref</cite> contains cartesian XYZ coordinates in the ECEF of a point (close) 
to the ellipsoid. The normal vector is computed for a point on the ellipsoid 
above or below <cite>ref</cite>.</p></li>
<li><p>‘normal’ : <cite>ref</cite> contains a normal vector with Cartesian coordinates. It does 
not necessarily have to be a unit vector (the function returns the unit vector).</p></li>
</ul>
</div></blockquote>
</dd>
<dt><strong>unit</strong><span class="classifier">{‘rad’, ‘deg’},  default = ‘rad’</span></dt><dd><p>Units for latitude and longitude, only useful in case the ‘plh’ options is used.</p>
</dd>
<dt><strong>rotmatrix</strong><span class="classifier">bool, default=False</span></dt><dd><p>Output the rotation matrix(es) as an optional output argument. The rotation matrix 
can be used for instance to convert the covariance matrix (when available and needed).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>xyz</strong><span class="classifier">ndarray with shape (…,3) similar to <cite>neu</cite></span></dt><dd><p>Cartesian XYZ coordinates. The origin is either in the center of the Earth or at the
position given by <cite>ref</cite>.</p>
</dd>
<dt><strong>R</strong><span class="classifier">ndarray with shape (…,3,3), optional</span></dt><dd><p>Rotation matrix(es), with <code class="docutils literal notranslate"><span class="pre">dxyz</span> <span class="pre">=</span> <span class="pre">neu</span> <span class="pre">&#64;</span> <span class="pre">R</span></code>. In case <cite>ref</cite> is a vector <cite>R</cite> is a 3-by-3 matrix , 
in case <cite>ref</cite> is a multidimensional array, <cite>R</cite> has one more dimension than <cite>ref</cite> with
shape (…,3,3). The rotation matrix can be used for instance to convert the covariance matrix 
(when available and needed). The rotation matrix is the “transpose” of the rotation matrix of 
<cite>xyz2neu</cite> and <cite>ellrotmatrix</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="pymgp.crstrans.xyz2neu.html#pymgp.crstrans.xyz2neu" title="pymgp.crstrans.xyz2neu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xyz2neu</span></code></a>, <a class="reference internal" href="pymgp.crstrans.covtransform.html#pymgp.crstrans.covtransform" title="pymgp.crstrans.covtransform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">covtransform</span></code></a>, <a class="reference internal" href="pymgp.crstrans.ellnormal.html#pymgp.crstrans.ellnormal" title="pymgp.crstrans.ellnormal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ellnormal</span></code></a>, <a class="reference internal" href="pymgp.crstrans.ellrotmatrix.html#pymgp.crstrans.ellrotmatrix" title="pymgp.crstrans.ellrotmatrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ellrotmatrix</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The rotation matrix differs from the Matlab version in the sense that it is the transpose.
This is intentional because of differences between Python and Matlab array storage, broadcasting 
rules, and matrix multiplication. Possible methods are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dxyz</span> <span class="o">=</span> <span class="n">neu</span> <span class="o">@</span> <span class="n">R</span>
<span class="n">dxyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">neu</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
<span class="n">dxyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...j,...ji&#39;</span><span class="p">,</span><span class="n">neu</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
<p>The third method using Einstein summation is the most general. The first two methods only 
work for dxyz.shape (:,3) or (3,), and with R.shape(3,3), but fail with higher dimensions. 
The rotation matrix also differs between the inverse functions <cite>xyz2neu</cite> and <cite>neu2xyz</cite> who return
transposed versions to each other so that the above mathematics remain the same.</p>
<p>To convert covariance matrices we recommend to use the function covtransform.</p>
<p class="rubric">Examples</p>
<p>Create some test data</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ref</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">52</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refxyz</span> <span class="o">=</span> <span class="n">plh2xyz</span><span class="p">([</span><span class="mi">52</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">neu</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>The following examples all have the same output as coordinate delta’s</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dxyz</span> <span class="o">=</span> <span class="n">neu2xyz</span><span class="p">(</span><span class="n">neu</span><span class="p">,</span> <span class="n">ref</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dxyz</span> <span class="o">=</span> <span class="n">neu2xyz</span><span class="p">(</span><span class="n">neu</span><span class="p">,</span> <span class="p">[</span><span class="mi">52</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dxyz</span> <span class="o">=</span> <span class="n">neu2xyz</span><span class="p">(</span><span class="n">neu</span><span class="p">,</span> <span class="n">refxyz</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dxyz</span><span class="p">)</span>
<span class="go">[-0.24168592  0.98554157  1.40367223]</span>
</pre></div>
</div>
<p>The following examples refer to the same point, but as absolute coordinates</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xyz</span> <span class="o">=</span> <span class="n">neu2xyz</span><span class="p">(</span><span class="n">neu</span><span class="p">,</span> <span class="n">refxyz</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;ecef&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyz</span> <span class="o">=</span> <span class="n">neu2xyz</span><span class="p">(</span><span class="n">neu</span><span class="p">,</span> <span class="p">[</span><span class="mi">52</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;ecef&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="go">[3925374.8591  274489.952  5002804.7492]</span>
</pre></div>
</div>
<p>You can use only latitude and longitude in <cite>ref</cite>, but not in ECEF mode where 
<cite>ref</cite> MUST have three coordinates</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dxyz</span> <span class="o">=</span> <span class="n">neu2xyz</span><span class="p">(</span><span class="n">neu</span><span class="p">,</span> <span class="p">[</span><span class="mi">52</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xyz</span> <span class="o">=</span> <span class="n">neu2xyz</span><span class="p">(</span><span class="n">neu</span><span class="p">,</span> <span class="p">[</span><span class="mi">52</span> <span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;ecef&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">  </span><span class="c">...</span>
<span class="gr">AssertionError</span>: <span class="n">Reference coordinate vector ref must have three coordinates when used in combination with origin=&#39;ecef&#39;.</span>
</pre></div>
</div>
<p>Examples with multi dimensional coordinate input <cite>neu</cite>. The second parameter <cite>ref</cite> can either
be a row vector or have the same shape as the first input <cite>neu</cite>. The number of dimensions is not
restricted to two.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neu</span> <span class="o">=</span> <span class="p">[[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">dxyz</span> <span class="o">=</span> <span class="n">neu2xyz</span><span class="p">(</span><span class="n">neu</span><span class="p">,</span> <span class="n">ref</span><span class="p">)</span>                    <span class="c1"># ref is a single coordinate doublet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dxyz</span><span class="p">)</span>
<span class="go">[[-0.24168592  0.98554157  1.40367223]</span>
<span class="go"> [-0.48337184  1.97108314  2.80734446]</span>
<span class="go"> [-2.3582736  -0.16490655  1.84698443]</span>
<span class="go"> [ 0.33513586  4.03320257  0.78801075]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dxyz1</span> <span class="o">=</span> <span class="n">neu2xyz</span><span class="p">(</span><span class="n">neu</span><span class="p">,</span> <span class="p">[</span><span class="n">ref</span> <span class="p">,</span><span class="n">ref</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">ref</span><span class="p">])</span>   <span class="c1"># matching shapes (ref can be different for each point)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dxyz2</span> <span class="o">=</span> <span class="n">neu2xyz</span><span class="p">(</span><span class="n">neu</span><span class="p">,</span> <span class="p">[</span> <span class="n">refxyz</span> <span class="p">,</span><span class="n">refxyz</span><span class="p">,</span> <span class="n">refxyz</span><span class="p">,</span> <span class="n">refxyz</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dxyz1</span><span class="o">-</span><span class="n">dxyz</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dxyz2</span><span class="o">-</span><span class="n">dxyz</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-8</span><span class="p">)</span>
<span class="go">True True</span>
</pre></div>
</div>
<p>Example with additional rotation matrix output</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dxyz</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">neu2xyz</span><span class="p">(</span><span class="n">neu</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">rotmatrix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Rotation matrix output</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="go">[[-0.7860912  -0.05496885  0.61566148]</span>
<span class="go"> [-0.06975647  0.99756405  0.        ]</span>
<span class="go"> [ 0.61416175  0.04294637  0.78801075]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">dxyz</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">neu</span><span class="p">)</span> <span class="o">@</span> <span class="n">R</span> <span class="o">&lt;</span> <span class="mf">1e-14</span><span class="p">))</span>  
<span class="go">True</span>
</pre></div>
</div>
<p>The following two examples do not give the same results because the up-direction 
is different (geodetic versus astronomic)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neu2xyz</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">refxyz</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">)</span>     <span class="c1"># same result as dxyz = neu2xyz(neu,ref)</span>
<span class="go">array([-0.24168592,  0.98554157,  1.40367223])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">neu2xyz</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">refxyz</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
<span class="go">array([-0.23711835,  0.98586097,  1.40422685])</span>
</pre></div>
</div>
</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="pymgp.crstrans.xyz2neu.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">pymgp.crstrans.xyz2neu</p>
      </div>
    </a>
    <a class="right-next"
       href="pymgp.crstrans.xyz2zas.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">pymgp.crstrans.xyz2zas</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pymgp.crstrans.neu2xyz"><code class="docutils literal notranslate"><span class="pre">neu2xyz()</span></code></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Hans van der Marel.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>